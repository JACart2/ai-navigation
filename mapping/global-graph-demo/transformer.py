import numpy as np

# Stack graph points (source)
P = np.array([
    [-458.2270202636719, -1226.00927734375, 1],
    [460.8482666015625, -1111.886962890625, 1],
    [93.16297912597656, 130.05372111002603, 1]
])

# Stack geo points (destination)
Q = np.array([
    [38.439560, -78.875325],
    [38.431218, -78.875571],
    [38.432906, -78.860845]
])

# Solve affine: Q = P @ M.T → M = (P⁻¹ @ Q).T
M = np.linalg.lstsq(P, Q, rcond=None)[0].T  # shape (2, 3)
def transform(p):
    p_aug = np.array([p[0], p[1], 1])
    return M @ p_aug


# 1472
# World: 38.439569, -78.875348
# Graph: -458.2270202636719, -1226.00927734375

# 5593
# World: 38.431254, -78.875588
# Graph: 460.8482666015625, -1111.886962890625

# 1355
# World: 38.432906, -78.860845
# Graph: 93.16297912597656, 130.05372111002603
